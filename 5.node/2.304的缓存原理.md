## 2. 304 的缓存原理

添加 Etag 标签。last-modified 304 网页上次请求没有更新，节省宽带和开销

- 1.服务器首先产生 Etag，服务器可在稍后使用它来判断页面是否被修改。本质上，客户端通过该几号传回服务器要求服务器验证（客户端）缓存
- 2.304 是 http 的状态吗，服务器用来标识这个文件有没有修改，不返回内容，浏览器接到这个状态码会去找浏览器缓存的文件
- 3.流程：客户端请求一个页面 A，服务器返回页面 A，并在 A 上加一个 Etag 客户端渲染该页面，并把 Etag 也存储在缓存中。客户端再次请求页面 A 并将上次请求的资源和 ETage 一起传递给服务器。服务器检查 Tage，并判断出该页面自上次客户端请求之后未被修改，直接返回 304
  - last-modified：客户端请求资源，同时有一个 last-modified 的属性标记此文件在服务器最后修改的时间，根据 http 协议。浏览器会向服务器发送一个 if-modified-since 报头，询问该事件之后文件是否被修改，没有修改返回 304
  * 有了 last-modified，为什么还要用 Etag?
    - 1.因为如果在一秒钟之内对一个文件进行两次更改，last-modified 就会不正确（last-modified 不能识别秒单位的修改）
    - 2.某些服务器不能精确的得到文件的最后修改时间
    - 3.一些文件也会周期性的更改，但是他的内容并不改变（仅仅改变修改的事件），这个时候我们并不希望客户端认为文件被修改，而重新 get
  * 有 Etag，为什么还要用 last-modified
    - 1.两者互不，Etag 的判断的缺陷，比如一些图片等静态文件的修改
    - 2.如果每次扫描内容都生成 Etag 比较，显然要比直接比较修改时间慢的多
  * Etag 是被请求变量的实体值（文件的索引节大小和最后修改的时间的 hash 值）
  * Etag 的值服务器端对文件的索引节，大小和最后的修改的事件进行 hash 后得到
